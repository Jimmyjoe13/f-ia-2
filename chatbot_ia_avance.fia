imprimer("ğŸ¤– === CHATBOT F-IA AVEC IA INTÃ‰GRÃ‰E ===")
imprimer("Chargement du systÃ¨me IA...")

soit config_ia = verifier_config_ia()
imprimer("ğŸ“Š Ã‰tat de la configuration IA:")
imprimer("  OpenAI:", config_ia["openai"])
imprimer("  DeepSeek:", config_ia["deepseek"])

soit plateformes = lister_plateformes_ia()
si (longueur(plateformes) == 0) {
    imprimer("âŒ Aucune plateforme IA configurÃ©e!")
    imprimer("ğŸ’¡ Configurez vos clÃ©s API dans le fichier .env")
    imprimer("   OPENAI_API_KEY=votre_cle_openai")
    imprimer("   DEEPSEEK_API_KEY=votre_cle_deepseek")
    arreter()
}

imprimer("âœ… Plateformes IA disponibles:", plateformes)

soit plateforme_defaut = plateformes[0]
soit modele_defaut = "gpt-4.1-nano"

si (plateforme_defaut == "deepseek") {
    modele_defaut = "deepseek-chat"
}

imprimer("ğŸ¯ Plateforme active:", plateforme_defaut)
imprimer("ğŸ§  ModÃ¨le:", modele_defaut)

soit nom_bot = "F-IA Assistant Pro"
soit contexte_bot = "Tu es un assistant intelligent crÃ©Ã© avec le langage F-IA. Tu es serviable, crÃ©atif et tu parles franÃ§ais naturellement."
soit compteur_messages = 0
soit historique = []

fonction ajouter_historique(message, reponse) {
    ajouter(historique, {"message": message, "reponse": reponse})
    si (longueur(historique) > 10) {
        retirer(historique, 0)
    }
}

fonction afficher_aide() {
    imprimer("ğŸ“– === AIDE CHATBOT F-IA PRO ===")
    imprimer("Commandes spÃ©ciales:")
    imprimer("  /aide       - Afficher cette aide")
    imprimer("  /stats      - Statistiques du bot")
    imprimer("  /historique - Voir les derniers Ã©changes")
    imprimer("  /modele     - Changer de modÃ¨le IA")
    imprimer("  /plateforme - Changer de plateforme IA")
    imprimer("  /reset      - RÃ©initialiser l'historique")
    imprimer("  quitter     - Fermer le chatbot")
    imprimer("")
    imprimer("ğŸ’¬ Parlez-moi naturellement pour une conversation IA!")
}

fonction afficher_stats() {
    imprimer("ğŸ“Š === STATISTIQUES ===")
    imprimer("Bot:", nom_bot)
    imprimer("Plateforme:", plateforme_defaut)
    imprimer("ModÃ¨le:", modele_defaut)
    imprimer("Messages Ã©changÃ©s:", compteur_messages)
    imprimer("Historique:", longueur(historique), "Ã©changes")
}

fonction afficher_historique() {
    imprimer("ğŸ“œ === HISTORIQUE ===")
    si (longueur(historique) == 0) {
        imprimer("Aucun historique disponible.")
    } sinon {
        soit i = 0
        tant_que (i < longueur(historique)) {
            soit echange = historique[i]
            imprimer("ğŸ‘¤ Vous:", echange["message"])
            imprimer("ğŸ¤– Bot:", echange["reponse"])
            imprimer("---")
            i = i + 1
        }
    }
}

fonction changer_modele() {
    imprimer("ğŸ§  ModÃ¨les disponibles pour", plateforme_defaut, ":")
    soit modeles = lister_modeles_ia(plateforme_defaut)
    soit i = 0
    tant_que (i < longueur(modeles)) {
        imprimer("  ", i + 1, ".", modeles[i])
        i = i + 1
    }
    imprimer("Tapez le numÃ©ro du modÃ¨le ou EntrÃ©e pour annuler:")
    soit choix = lire()
    
    si (choix != "") {
        si (choix == "1") {
            modele_defaut = modeles[0]
            imprimer("âœ… ModÃ¨le changÃ© pour:", modele_defaut)
        } sinon si (choix == "2") {
            si (longueur(modeles) > 1) {
                modele_defaut = modeles[1]
                imprimer("âœ… ModÃ¨le changÃ© pour:", modele_defaut)
            } sinon {
                imprimer("âŒ NumÃ©ro invalide")
            }
        } sinon si (choix == "3") {
            si (longueur(modeles) > 2) {
                modele_defaut = modeles[2]
                imprimer("âœ… ModÃ¨le changÃ© pour:", modele_defaut)
            } sinon {
                imprimer("âŒ NumÃ©ro invalide")
            }
        } sinon {
            imprimer("âŒ NumÃ©ro invalide")
        }
    }
}

fonction changer_plateforme() {
    imprimer("ğŸŒ Plateformes disponibles:")
    soit i = 0
    tant_que (i < longueur(plateformes)) {
        imprimer("  ", i + 1, ".", plateformes[i])
        i = i + 1
    }
    imprimer("Tapez le numÃ©ro de la plateforme ou EntrÃ©e pour annuler:")
    soit choix = lire()
    
    si (choix != "") {
        si (choix == "1") {
            plateforme_defaut = plateformes[0]
            si (plateforme_defaut == "openai") {
                modele_defaut = "gpt-4.1-nano"
            } sinon si (plateforme_defaut == "deepseek") {
                modele_defaut = "deepseek-chat"
            }
            imprimer("âœ… Plateforme changÃ©e pour:", plateforme_defaut)
            imprimer("ğŸ§  ModÃ¨le adaptÃ©:", modele_defaut)
        } sinon si (choix == "2") {
            si (longueur(plateformes) > 1) {
                plateforme_defaut = plateformes[1]
                si (plateforme_defaut == "openai") {
                    modele_defaut = "gpt-3.5"
                } sinon si (plateforme_defaut == "deepseek") {
                    modele_defaut = "deepseek-chat"
                }
                imprimer("âœ… Plateforme changÃ©e pour:", plateforme_defaut)
                imprimer("ğŸ§  ModÃ¨le adaptÃ©:", modele_defaut)
            } sinon {
                imprimer("âŒ NumÃ©ro invalide")
            }
        } sinon {
            imprimer("âŒ NumÃ©ro invalide")
        }
    }
}

imprimer("")
imprimer("ğŸ‰ Bienvenue dans", nom_bot, "!")
imprimer("PropulsÃ© par", plateforme_defaut, "avec le modÃ¨le", modele_defaut)
afficher_aide()

tant_que (vrai) {
    imprimer("")
    imprimer("ğŸ‘¤ Vous:")
    soit message_utilisateur = lire()
    
    si (message_utilisateur == "quitter") {
        imprimer("ğŸ‘‹ Merci d'avoir utilisÃ©", nom_bot, "!")
        imprimer("ğŸ’» DÃ©veloppÃ© avec le langage F-IA")
        arreter()
    } sinon si (message_utilisateur == "/aide") {
        afficher_aide()
    } sinon si (message_utilisateur == "/stats") {
        afficher_stats()
    } sinon si (message_utilisateur == "/historique") {
        afficher_historique()
    } sinon si (message_utilisateur == "/modele") {
        changer_modele()
    } sinon si (message_utilisateur == "/plateforme") {
        changer_plateforme()
    } sinon si (message_utilisateur == "/reset") {
        historique = []
        compteur_messages = 0
        imprimer("ğŸ”„ Historique rÃ©initialisÃ©!")
    } sinon si (message_utilisateur == "") {
        imprimer("ğŸ’­ Tapez quelque chose ou /aide pour l'aide")
    } sinon {
        imprimer("ğŸ¤–", nom_bot, "rÃ©flÃ©chit...")
        
        soit reponse_ia = generer_reponse_bot(
            plateforme_defaut,
            modele_defaut,
            message_utilisateur,
            contexte_bot
        )
        
        imprimer("ğŸ¤–", nom_bot, ":", reponse_ia)
        
        ajouter_historique(message_utilisateur, reponse_ia)
        compteur_messages = compteur_messages + 1
    }
}
